{"version":3,"file":"media.js","mappings":"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","sources":["webpack://wp-target-crop/./src/js/components/modal.jsx","webpack://wp-target-crop/external window \"React\"","webpack://wp-target-crop/external window \"ReactDOM\"","webpack://wp-target-crop/external window \"ReactJSXRuntime\"","webpack://wp-target-crop/external window [\"wp\",\"apiFetch\"]","webpack://wp-target-crop/external window [\"wp\",\"components\"]","webpack://wp-target-crop/webpack/bootstrap","webpack://wp-target-crop/webpack/runtime/compat get default export","webpack://wp-target-crop/webpack/runtime/define property getters","webpack://wp-target-crop/webpack/runtime/hasOwnProperty shorthand","webpack://wp-target-crop/webpack/runtime/make namespace object","webpack://wp-target-crop/./src/js/media.js"],"sourcesContent":["import React, { useCallback, useState, useEffect } from \"react\";\nimport { FocalPointPicker } from \"@wordpress/components\";\nimport apiFetch from \"@wordpress/api-fetch\";\n\nconst PortalContent = ({ onClose, mediaId }) => {\n  console.log(\"PortalContent\", mediaId);\n\n  const [loading, setLoading] = useState(false);\n  const [focalPoint, setFocalPoint] = useState({ x: 0.5, y: 0.5 });\n  const [hasChanges, setHasChanges] = useState(false);\n  const [media, setMedia] = useState(null);\n\n  const mediaFetch = useCallback(async () => {\n    await apiFetch({\n      path: `/wp/v2/media/${mediaId}`,\n    }).then((response) => {\n      // Media\n      setMedia(response);\n      setFocalPoint(\n        response.meta.focal_point || {\n          x: 0.5,\n          y: 0.5,\n        }\n      );\n      setLoading(false);\n    });\n  }, [mediaId]);\n\n  const focalPointSave = useCallback(async () => {\n    // Send the\n\n    await apiFetch({\n      path: `/wp-target-crop/v1/focal-point/${mediaId}`,\n      method: \"POST\",\n      data: {\n        focalPoint,\n      },\n    }).then((response) => {\n      if (response) {\n        onClose();\n      } else {\n        // Handle error\n        alert(\"Error: Focus point not saved\");\n      }\n\n      console.log(response);\n    });\n  }, [focalPoint, mediaId, onClose]);\n\n  useEffect(async () => {\n    if (loading) {\n      return;\n    }\n\n    setLoading(true);\n\n    await mediaFetch();\n  }, [mediaId]);\n\n  if (!media || loading) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        position: \"fixed\",\n        top: 0,\n        left: 0,\n        width: \"100%\",\n        height: \"100%\",\n        backgroundColor: \"rgba(0, 0, 0, 0.5)\",\n        display: \"flex\",\n        justifyContent: \"center\",\n        alignItems: \"center\",\n        zIndex: 9999999,\n      }}\n      onClick={onClose} // Close the portal when clicking outside\n    >\n      <div\n        className=\"relative bg-white w-full h-auto p-10 max-w-3xl max-h-3xl\"\n        onClick={(e) => e.stopPropagation()} // Prevent closing when clicking inside\n      >\n        <FocalPointPicker\n          url={media.source_url}\n          dimensions={{\n            width: media.media_details.width,\n            height: media.media_details.height,\n          }}\n          value={focalPoint}\n          onChange={(focalPoint) => {\n            setFocalPoint(focalPoint);\n            setHasChanges(true);\n          }}\n        />\n\n        <div className=\"flex gap-x-2\">\n          <button\n            className=\"button button-primary button-large\"\n            onClick={focalPointSave}\n            disabled={!hasChanges}\n          >\n            Save\n          </button>\n          <button className=\"button button-large\" onClick={onClose}>\n            Close\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default PortalContent;\n","module.exports = window[\"React\"];","module.exports = window[\"ReactDOM\"];","module.exports = window[\"ReactJSXRuntime\"];","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"components\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import React from \"react\";\n\nimport PortalContent from \"./components/modal\";\nimport { createRoot } from \"react-dom\";\n\n// Listen to button clicks and log the image ID\ndocument.addEventListener(\"click\", function (event) {\n  if (event.target.classList.contains(\"wp_target_crop_focal_point\")) {\n    // Get the image ID from the button ID\n    const button = event.target;\n    const imageId = button.getAttribute(\"imageId\");\n\n    if (imageId) {\n      // Create a Portal and append it to the body and render\n      event.preventDefault();\n\n      // Create a container for the portal\n      const portalContainer = document.createElement(\"div\");\n      portalContainer.id = \"custom-portal-container\";\n      document.body.appendChild(portalContainer);\n\n      // Render the portal content\n      const root = createRoot(portalContainer);\n      root.render(\n        <PortalContent\n          onClose={() => {\n            // Unmount and remove the portal\n            root.unmount();\n            document.body.removeChild(portalContainer);\n          }}\n          mediaId={imageId}\n        />\n      );\n    }\n  }\n});\n"],"names":["React","useCallback","useState","useEffect","FocalPointPicker","apiFetch","jsx","_jsx","jsxs","_jsxs","PortalContent","onClose","mediaId","console","log","loading","setLoading","focalPoint","setFocalPoint","x","y","hasChanges","setHasChanges","media","setMedia","mediaFetch","path","then","response","meta","focal_point","focalPointSave","method","data","alert","style","position","top","left","width","height","backgroundColor","display","justifyContent","alignItems","zIndex","onClick","children","className","e","stopPropagation","url","source_url","dimensions","media_details","value","onChange","disabled","createRoot","document","addEventListener","event","target","classList","contains","button","imageId","getAttribute","preventDefault","portalContainer","createElement","id","body","appendChild","root","render","unmount","removeChild"],"sourceRoot":""}